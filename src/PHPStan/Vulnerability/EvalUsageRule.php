<?php

declare(strict_types=1);

namespace Sakoo\Framework\Core\PHPStan\Vulnerability;

use PhpParser\Node;
use PhpParser\Node\Expr\Eval_;
use PHPStan\Analyser\Scope;
use PHPStan\Rules\Rule;
use PHPStan\Rules\RuleErrorBuilder;
use Sakoo\Framework\Core\Doc\Attributes\DontDocument;

/**
 * @implements Rule<Eval_>
 */
#[DontDocument]
class EvalUsageRule implements Rule
{
	final public const string RULE_SIGNATURE = 'sakoo.vulnerability.evalUsage';

	public function getNodeType(): string
	{
		return Eval_::class;
	}

	public function processNode(Node $node, Scope $scope): array
	{
		return [RuleErrorBuilder::message("Usage of 'eval' is dangerous. Consider alternatives.")->identifier(self::RULE_SIGNATURE)->build()];
	}
}
