<?php

declare(strict_types=1);

namespace PHPStan\Vulnerability;

use PHPStan\Rules\Rule;
use PHPStan\Testing\RuleTestCase;
use PHPUnit\Framework\Attributes\Test;
use Sakoo\Framework\Core\PHPStan\Vulnerability\EvalUsageRule;
use Sakoo\Framework\Core\Tests\PHPStan\PHPStanTestCase;

/**
 * @extends RuleTestCase<EvalUsageRule>
 */
final class EvalUsageRuleTest extends PHPStanTestCase
{
	protected function getRule(): Rule
	{
		return new EvalUsageRule();
	}

	#[Test]
	public function detects_eval_function_calls(): void
	{
		$errorMessage = "Usage of 'eval' is dangerous. Consider alternatives.";

		$this->analyse([__DIR__ . '/Stub.php'], [
			[sprintf($errorMessage, 'eval'), 4],
		]);
	}
}
